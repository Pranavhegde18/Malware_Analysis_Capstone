# Define the folder path where the information will be stored
$folderPath = "C:\BrowserInfo"

# Create the folder if it doesn't exist
if (-not (Test-Path -Path $folderPath)) {
    New-Item -ItemType Directory -Path $folderPath | Out-Null
}

# Get browser-related information

# Google Chrome
$chromeBookmarksPath = "$env:LOCALAPPDATA\Google\Chrome\User Data\Default\Bookmarks"

# Copy the Chrome bookmarks file to the folder
Copy-Item -Path $chromeBookmarksPath -Destination $folderPath -ErrorAction SilentlyContinue

# Function to read and list bookmarks from the JSON file
function Get-Bookmarks {
    param (
        [Parameter(Mandatory = $true)]
        [ValidateNotNullOrEmpty()]
        [String]$BookmarksPath
    )

    try {
        $bookmarksJson = Get-Content -Path $BookmarksPath -Raw | ConvertFrom-Json
        $bookmarks = $bookmarksJson.roots.bookmark_bar.children
        $bookmarks | Select-Object -Property name, url
    }
    catch {
        Write-Host "Failed to read bookmarks: $_" -ForegroundColor Red
    }
}

# Create a sample bookmark in Chrome
$bookmarkName = "Pranav"
$bookmarkUrl = "https://pranav.com"
$bookmark = @{
    type = "url"
    name = $bookmarkName
    url = $bookmarkUrl
}

# Read the current bookmarks and append the new bookmark
$bookmarksData = Get-Content -Path $chromeBookmarksPath -Raw | ConvertFrom-Json
$bookmarksData.roots.bookmark_bar.children += $bookmark

# Save the modified bookmarks to the file
$modifiedBookmarksJson = $bookmarksData | ConvertTo-Json -Depth 10
$modifiedBookmarksJson | Set-Content -Path $chromeBookmarksPath

# List the bookmarks
$bookmarksList = Get-Bookmarks -BookmarksPath $chromeBookmarksPath
$bookmarksList
