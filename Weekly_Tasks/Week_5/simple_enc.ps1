$folderPath = "D:\Drive\APranav\Capstone\Phase2\DP\test"
$shift = 25
$files = Get-ChildItem -Path $folderPath
$encryptedFolderPath = Join-Path -Path $folderPath -ChildPath "Encrypted"
New-Item -ItemType Directory -Path $encryptedFolderPath | Out-Null
foreach ($file in $files) {
    $content = Get-Content -Path $file.FullName -Raw
    $characters = $content.ToCharArray()
    for ($i = 0; $i -lt $characters.Length; $i++) {
        $char = $characters[$i]

        if ($char -match "[a-zA-Z]") {
            $ascii = [int]$char
            if ($char -cmatch "[a-z]") {
                $encryptedChar = [char]((($ascii - 97 + $shift) % 26) + 97)
            }
            elseif ($char -cmatch "[A-Z]") {
                $encryptedChar = [char]((($ascii - 65 + $shift) % 26) + 65)
            }
            $characters[$i] = $encryptedChar
        }
    }
    $encryptedContent = -join $characters
    $encryptedFilePath = Join-Path -Path $encryptedFolderPath -ChildPath $file.Name
    $encryptedContent | Out-File -FilePath $encryptedFilePath -Encoding UTF8
    Remove-Item -Path $file.FullName -Force
}