import vt
import hashlib

# Specify the path to the executable file
executable_path = r"D:\Drive\APranav\6thS\Capstone\packed\upx-4.0.2-win64\infectd.exe"

# Specify your VirusTotal API key
api_key = "529b0215b4a80f64182c40669b362e2983967c9618b646bb250d4b729e590ed0"

# Create a new instance of the VirusTotal API client
client = vt.Client(api_key)

# Calculate the hash of the file
with open(executable_path, "rb") as file:
    file_content = file.read()
    file_hash = hashlib.sha256(file_content).hexdigest()

# Get the analysis results based on the file hash
analysis = client.get_object(f"/files/{file_hash}")

# Get the analysis results
results = client.get_object(f"/files/{file_hash}/results")
print(results)

# Close the VirusTotal API client
client.close()
