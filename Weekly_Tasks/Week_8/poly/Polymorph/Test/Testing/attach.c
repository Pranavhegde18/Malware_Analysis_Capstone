#include <stdio.h>
#include <stdlib.h>

int main() {
    FILE *wordDoc = fopen("document.docx", "ab");  // Open the Word document in append binary mode
    FILE *self = fopen("self.exe", "rb");  // Open a copy of the executable in read binary mode

    if (wordDoc == NULL || self == NULL) {
        printf("Error opening files.\n");
        exit(1);
    }

    // Find the end of the Word document
    fseek(wordDoc, 0, SEEK_END);
    long int wordDocSize = ftell(wordDoc);

    // Copy the contents of the executable into the Word document byte by byte
    rewind(self);  // Start reading the self.exe file from the beginning

    int ch;
    while ((ch = fgetc(self)) != EOF) {
        fputc(ch, wordDoc);
    }

    fclose(wordDoc);
    fclose(self);

    printf("Copy complete.\n");
    return 0;
}
