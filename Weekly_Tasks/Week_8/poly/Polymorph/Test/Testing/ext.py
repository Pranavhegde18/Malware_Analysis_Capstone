def extract_mz_from_word_doc(word_doc_path, output_exe_path):
    with open(word_doc_path, 'rb') as doc_file:
        doc_data = doc_file.read()

    # Find the end of the Word document
    eof_offset = doc_data.find(b'\x2c\x00\x00\x00\x00')
    print(eof_offset)

    # Extract the MZ executable part
    mz_data = doc_data[eof_offset + 5:]

    # Write the extracted MZ data to a new executable file
    with open(output_exe_path, 'wb') as exe_file:
        exe_file.write(mz_data)

# Usage
word_doc_path = 'document.docx'
output_exe_path = 'output.exe'

extract_mz_from_word_doc(word_doc_path, output_exe_path)
