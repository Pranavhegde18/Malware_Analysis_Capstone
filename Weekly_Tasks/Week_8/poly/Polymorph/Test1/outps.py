import subprocess
import psutil
import os
import threading

def get_system_events_info():
    # Get process and thread IDs
    process_id = os.getpid()
    thread_id = threading.current_thread().ident
    
    # You can use psutil to get more system information if needed, e.g., CPU, memory, etc.
    # Example:
    # cpu_percent = psutil.cpu_percent()
    # memory_info = psutil.virtual_memory()
    # psutil.process_iter(): Get an iterator for all running processes.
    # process.name(): Get the name of the process.
    # process.pid: Get the process ID.
    # process.cpu_percent(): Get the CPU utilization for a specific process as a percentage.
    # process.memory_info(): Get memory usage statistics for a specific process.
    # process.connections(): Get network connections used by the process.
    # psutil.cpu_percent(): Get the overall CPU utilization as a percentage.
    # psutil.cpu_percent(percpu=True): Get the CPU utilization for each core as a list.
    # psutil.cpu_times(): Get CPU times (user, system, idle, etc.).
    # psutil.cpu_count(): Get the number of logical CPUs in the system.
    # ......

    return f"Process ID: {process_id}, Thread ID: {thread_id}"

def redirect_cmd_output_to_file(command, output_file):
    with open(output_file, 'w') as f:
        system_events_info = get_system_events_info()
        f.write(f"System Events Info: {system_events_info}\n\n")

        # Run the command and capture its output
        process = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, text=True)
        stdout, stderr = process.communicate()

        # Write the command output to the file
        f.write(f"Command Output:\n{stdout}\n")

        # In case of errors, write stderr to the file as well
        if stderr:
            f.write(f"\nErrors:\n{stderr}\n")

if __name__ == "__main__":
    # Replace 'your_command_here' with the actual command you want to run
    # Replace 'output.txt' with the desired output file name
    redirect_cmd_output_to_file('python some.py', 'output.txt')
