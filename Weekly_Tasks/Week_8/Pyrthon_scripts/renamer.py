import ast
import random
import string
import re
import sys
import os

def generate_weird_names():
    names = []
    while len(names) < 50:
        name = ''.join(random.choice(string.ascii_lowercase) for _ in range(10))
        if name not in names:
            names.append(name)
    return names

def extract_functions_variables(tree):
    functions = {}
    variables = {}

    for node in ast.walk(tree):
        if isinstance(node, ast.FunctionDef):
            functions[node.name] = (node.lineno, node.col_offset, node.end_col_offset)
        elif isinstance(node, ast.Assign):
            if isinstance(node.targets[0], ast.Name):
                variable_name = node.targets[0].id
                if variable_name not in variables:
                    variables[variable_name] = []
                variables[variable_name].append((node.lineno, node.col_offset, node.end_col_offset))

    return functions, variables

def replace_function_variable_names(file_name):
    try:
        with open(file_name, 'r') as file:
            code = file.read()
            tree = ast.parse(code)

            functions, variables = extract_functions_variables(tree)

            weird_names = generate_weird_names()

            for old_name in functions:
                pattern = r'\b{}\b'.format(re.escape(old_name))
                new_name = weird_names.pop(0)
                code = re.sub(pattern, new_name, code)

            for old_name in variables:
                pattern = r'\b{}\b'.format(re.escape(old_name))
                new_name = weird_names.pop(0)
                code = re.sub(pattern, new_name, code)

            modified_file_name = "modified_" + file_name
            with open(modified_file_name, 'w') as file:
                file.write(code)

            print("Names replaced successfully. Modified code written to '{}'.".format(modified_file_name))

    except FileNotFoundError:
        print("File not found.")

if len(sys.argv) < 2:
    print("Usage: python filename.py <file_name>")
else:
    file_name = sys.argv[1]
    if file_name.endswith(".py"):
        replace_function_variable_names(file_name)
    else:
        print("Invalid file type. Only Python files (.py) are supported.")
