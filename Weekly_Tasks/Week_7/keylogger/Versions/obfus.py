import re

def check_for_obfuscation(file_content):
    # Convert the bytes content to a string
    file_content_str = file_content.decode(errors='ignore')

    # Regular expressions to detect XOR and Base64 patterns
    xor_pattern = r'\bxor\b|\b^|\bxor[ \t]+\w+[ \t]*\)|\b\^\b'
    base64_pattern = r'[^a-zA-Z0-9+/=]'

    # Check for XOR obfuscation
    xor_matches = re.findall(xor_pattern, file_content_str, re.IGNORECASE)

    # Check for Base64 obfuscation
    base64_matches = re.findall(base64_pattern, file_content_str)

    # Calculate an obfuscation score based on the number of matches
    obfuscation_score = len(xor_matches) + len(base64_matches)

    return obfuscation_score

# Example usage
file_to_analyze = "infectd.exe"
with open(file_to_analyze, 'rb') as file:
    file_content = file.read()

obfuscation_score = check_for_obfuscation(file_content)
print("Obfuscation Score:", obfuscation_score)

