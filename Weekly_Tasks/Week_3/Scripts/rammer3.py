# Define the IP address and port to ping
$ipAddress = "192.168.0.1"
$port = 12345

# Function to check if a port is open
function Test-PortOpen {
    param (
        [string]$ip,
        [int]$port
    )
    try {
        $tcpClient = New-Object System.Net.Sockets.TcpClient
        $tcpClient.Connect($ip, $port)
        $tcpClient.Close()
        return $true
    } catch {
        return $false
    }
}

# Ping the IP address and port
if (Test-PortOpen $ipAddress $port) {
    # Port is open, send the "pull me" message
    $client = New-Object System.Net.Sockets.TcpClient($ipAddress, $port)
    $stream = $client.GetStream()
    $writer = New-Object System.IO.StreamWriter($stream)
   
    $message = "pull me"
    $writer.WriteLine($message)
    $writer.Flush()
   
    $reader = New-Object System.IO.StreamReader($stream)
    $response = $reader.ReadLine()
   
    Write-Host "Received response: $response"
   
    # Perform actions with the received response
   
    $reader.Close()
    $writer.Close()
    $stream.Close()
    $client.Close()
} else {
    Write-Host "Port is not open or not responsive."
}

