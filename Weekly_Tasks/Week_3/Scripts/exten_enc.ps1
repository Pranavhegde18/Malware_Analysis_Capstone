# Define the folder path and shift value
$folderPath = "D:\Drive\APranav\Capstone\Phase2\DP\test"
$shift = 25

# Get the list of files in the folder
$files = Get-ChildItem -Path $folderPath

# Determine the path for the encrypted folder
$encryptedFolderPath = Join-Path -Path $folderPath -ChildPath "Encrypted"

# Check if the encrypted folder already exists
if (-not (Test-Path -Path $encryptedFolderPath -PathType Container)) {
    # Create the encrypted folder if it doesn't exist
    New-Item -ItemType Directory -Path $encryptedFolderPath | Out-Null
}

# Encrypt and save each file in the new folder
foreach ($file in $files) {
    if ($file.Extension -eq ".txt") {
        # Read the content of the file
        $content = Get-Content -Path $file.FullName -Raw

        # Convert the content to an array of characters
        $characters = $content.ToCharArray()

        # Encrypt each character in the array
        for ($i = 0; $i -lt $characters.Length; $i++) {
            $char = $characters[$i]

            # Check if the character is a letter
            if ($char -match "[a-zA-Z]") {
                # Determine the ASCII value of the character
                $ascii = [int]$char

                # Encrypt the character using Caesar cipher
                if ($char -cmatch "[a-z]") {
                    $encryptedChar = [char]((($ascii - 97 + $shift) % 26) + 97)
                }
                elseif ($char -cmatch "[A-Z]") {
                    $encryptedChar = [char]((($ascii - 65 + $shift) % 26) + 65)
                }

                # Replace the character in the array with the encrypted character
                $characters[$i] = $encryptedChar
            }
        }

        # Convert the array of characters back to a string
        $encryptedContent = -join $characters

        # Determine the path for the encrypted file
        $encryptedFilePath = Join-Path -Path $encryptedfolderPath -ChildPath ($file.BaseName + ".enc")

        # Save the encrypted content to the encrypted file
        $encryptedContent | Out-File -FilePath $encryptedFilePath -Encoding UTF8

        # Remove the original file if it is a file (not a directory)
        if ($file.PSIsContainer -eq $false) {
            Remove-Item -Path $file.FullName -Force
        }
    }
}

Write-Host "Encryption complete. Original files deleted. Encrypted files saved in: $encryptedFolderPath"


